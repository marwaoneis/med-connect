{"version":3,"sources":["auth.middleware.js"],"names":["jwt","require","req","res","next","authHeader","headers","authenticateToken","token","split","verify","process","env","JWT_SECRET","err","user","sendStatus"],"mappings":"aAAA,IAAMA,IAAMC,QAAQ,gBAAdD,kBAAc,SAAAE,EAADC,EAAnBC,GAGE,IAAMC,EAAaH,EAAII,QAAJ,cADfC,EAAAA,GAAoBF,EAApBE,MAAAA,KAAqBL,GAEzB,GAAcG,MAARG,EAAQH,OAAcA,EAAAA,WAAWI,KAIvCT,IAAIU,OAAOF,EAAOG,QAAQC,IAAIC,WAAY,SAAAC,EAAAC,GACxC,GAAID,EAAK,OAAOX,EAAIa,WAAW,KAG/BZ,EAAIW,KAAAA,EAJNX,OASAG,OAAAA,QAAAA,CADFA,kBAAAA","file":"auth.middleware.min.js","sourcesContent":["const jwt = require(\"jsonwebtoken\");\n\nconst authenticateToken = (req, res, next) => {\n  const authHeader = req.headers[\"authorization\"];\n  const token = authHeader && authHeader.split(\" \")[1];\n\n  if (token == null) return res.sendStatus(401);\n\n  jwt.verify(token, process.env.JWT_SECRET, (err, user) => {\n    if (err) return res.sendStatus(403);\n\n    req.user = user;\n    next();\n  });\n};\n\nmodule.exports = {\n  authenticateToken,\n};\n"]}