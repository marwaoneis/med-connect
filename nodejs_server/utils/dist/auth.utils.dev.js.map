{"version":3,"sources":["auth.utils.js"],"names":["jwt","require","generateToken","user","console","log","process","env","JWT_SECRET","sign","id","_id","role","expiresIn","sendResponseWithToken","statusCode","res","token","status","json","module","exports"],"mappings":";;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,IAAD,EAAU;AAC9BC,EAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BC,OAAO,CAACC,GAAR,CAAYC,UAAxC;AAEA,SAAOR,GAAG,CAACS,IAAJ,CAAS;AAAEC,IAAAA,EAAE,EAAEP,IAAI,CAACQ,GAAX;AAAgBC,IAAAA,IAAI,EAAET,IAAI,CAACS;AAA3B,GAAT,EAA4CN,OAAO,CAACC,GAAR,CAAYC,UAAxD,EAAoE;AACzEK,IAAAA,SAAS,EAAE,KAD8D,CACvD;;AADuD,GAApE,CAAP;AAGD,CAND;;AAQA,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACX,IAAD,EAAOY,UAAP,EAAmBC,GAAnB,EAA2B;AACvD,MAAMC,KAAK,GAAGf,aAAa,CAACC,IAAD,CAA3B;AACAa,EAAAA,GAAG,CAACE,MAAJ,CAAWH,UAAX,EAAuBI,IAAvB,CAA4B;AAAET,IAAAA,EAAE,EAAEP,IAAI,CAACQ,GAAX;AAAgBM,IAAAA,KAAK,EAALA;AAAhB,GAA5B;AACD,CAHD;;AAKAG,MAAM,CAACC,OAAP,GAAiB;AACfnB,EAAAA,aAAa,EAAbA,aADe;AAEfY,EAAAA,qBAAqB,EAArBA;AAFe,CAAjB","sourcesContent":["const jwt = require(\"jsonwebtoken\");\n\nconst generateToken = (user) => {\n  console.log(\"JWT Secret: \", process.env.JWT_SECRET);\n\n  return jwt.sign({ id: user._id, role: user.role }, process.env.JWT_SECRET, {\n    expiresIn: \"24h\", // Token expires in 24 hours\n  });\n};\n\nconst sendResponseWithToken = (user, statusCode, res) => {\n  const token = generateToken(user);\n  res.status(statusCode).json({ id: user._id, token });\n};\n\nmodule.exports = {\n  generateToken,\n  sendResponseWithToken,\n};\n"],"file":"auth.utils.dev.js"}